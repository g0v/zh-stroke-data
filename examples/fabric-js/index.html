<!DOCTYPE html>
<html lang="en" style="height: 100%;">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>常用國字標準字體筆劃 in Fabric.js</title>
        <link rel="stylesheet" href="/css/demo.css" type="text/css" media="screen">
        <script src="/js/jquery-1.9.1.min.js"></script>
        <script src="/js/gl-matrix-min.js"></script>
        <script src="/js/sax.js"></script>
        <script src="/js/q.min.js"></script>
        <script src="/js/utils.stroke-words.js"></script>
        <script src="./js/fabric.js"></script>
    </head>
    <body style="margin: 0; padding: 0; height: 100%;">
        <canvas id="c"></canvas>
        <p id="copyright">常用國字標準字體筆劃</p>
        <script>
          var canvas = new fabric.Canvas("c");
          $body = $("body");
          canvas.setWidth($body.width());
          canvas.setHeight($body.height());
          var word = new fabric.Group();
          var data = new WordStroker.utils.StrokeData({url: "/json/"})
          var c    = WordStroker.utils.sortSurrogates("萌");
          var cp   = c[0].cp
          paths = []
          data.get(cp).then(function(strokes) {
            for (i in strokes) {
              stroke = strokes[i];
              var path = ""
              for (j in stroke.outline) {
                cmd = stroke.outline[j];
                path += cmd.type + " ";
                switch (cmd.type) {
                  case "M":
                    path += cmd.x + " ";
                    path += cmd.y + " ";
                    break;
                  case "L":
                    path += cmd.x + " ";
                    path += cmd.y + " ";
                    break;
                  case "Q":
                    path += cmd.begin.x + " ";
                    path += cmd.begin.y + " ";
                    path += cmd.end.x + " ";
                    path += cmd.end.y + " ";
                    break;
                  case "C":
                    path += cmd.begin.x + " ";
                    path += cmd.begin.y + " ";
                    path += cmd.mid.x + " ";
                    path += cmd.mid.y + " ";
                    path += cmd.end.x + " ";
                    path += cmd.end.y + " ";
                    break;
                }
              }
              p = new fabric.Path(path + "z");
              p.fill = "white";
              word.add(p);
            }
            word.set({left: 50, top: 50});
            word.scaleX = word.scaleY = 0.3;
            canvas.add(word);
          });
        </script>
    </body>
</html>
